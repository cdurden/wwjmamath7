DOCUMENT();

loadMacros(
"PGstandard.pl",
"parserRadioButtons.pl",
"compoundProblem.pl",
#"compoundProblem5.pl",
"PGML.pl",
"scaffold.pl",
);

$isProfessor = ($studentLogin eq 'dpvc' || $studentLogin eq 'professor');

$cp = new compoundProblem(
  parts => 2,                  # the total number of parts in this problem
  totalAnswers => 3,           # total answers in all parts combined
  parserValues => 1,           # make parser objects from student answers
  allowReset => $isProfessor,  # professors get Reset button for testing
);

$mc1 = RadioButtons(
    [ "The dragonfly is 4.5 feet per second faster.", "The dragonfly is 20.5 feet per second faster.", "The butterfly is 4.5 feet per second faster.", "The butterfly is 24 feet per second faster." ],
    "The dragonfly is 4.5 feet per second faster.",
    labels => "ABC" );

$mc2 = RadioButtons(
    [ "The dragonfly's speed is greater.", "The butterfly's speed is greater." ],
    "The dragonfly's speed is greater.",
    labels => "ABC" );

BEGIN_TEXT
$PAR
Suppose that a butterfly can fly 82 feet in 4 seconds. A dragonfly can fly 50 feet in 2 seconds. Which can fly faster and by how much?
END_TEXT

$ans_hash1 = $mc1->cmp()->evaluate(
    $inputs_ref->{ANS_NUM_TO_NAME(1)} );

if ($ans_hash1->{student_ans} ne '' && $ans_hash1->{score} == 0) {
#$cp->part(2);
$cp->incrementPart();
BEGIN_TEXT
$PAR
Answer incorrect
END_TEXT
} 

$part = $cp->part();

BEGIN_TEXT
$PAR
$BR
\{ $mc1->buttons() \}
END_TEXT

LABELED_ANS('mc1', $mc1->cmp() );

}

BEGIN_TEXT
$PAR
$ans_hash1->{student_ans}
$BR
$ans_hash1->{score}
$BR
Part: $part

END_TEXT

if ($part == 3) {
TEXT(beginproblem());
Scaffold::Begin();
    
Section::Begin("Part 1: The first part");
BEGIN_PGML
This is the text for part 1.  [` 1+1 = `] [_________]{"2"}
END_PGML
Section::End();
    
Section::Begin("Part 2: The second part");
BEGIN_PGML
This is text for the second part.  [` 2 * 2 = `] [_________]{"4"}
END_PGML
Section::End();

Section::Begin("Part 3: The third part");
BEGIN_PGML
This is text for the third part.  [` 1 + 2 + 4 = `] [_________]{"7"}
END_PGML
Section::End();
  
Scaffold::End();
}

if ($part == 2) {
Context("Numeric");
$rate_a = Compute('82/4');
$rate_b = Compute('50/2');
$difference = Compute('50/2-82/4');

#NAMED_ANS(
#  mc1 => $mc1->cmp(),
#  rate_a => $rate_a->cmp(),
#  rate_b => $rate_b->cmp(),
#  mc2 => $mc2->cmp(),
#  diff => $difference->cmp(),
#);

BEGIN_TEXT
$PAR
The answer that you entered was incorrect. The following sections will guide you through the solution.

END_TEXT

$scaffold = Scaffold();
INITIALIZE_SCAFFOLD('$scaffold');
TEXT(beginproblem());


##############
#  Section 1
##############

Context()->texStrings;
DISPLAY_SECTION( { name=>"1: Find the unit rates", 
             canshow =>1, #always true
             iscorrect=>$scaffold->requireCorrect(1,2), 
             section=>1 #designates that this is the first section
},   <<'END_SECTION'); 
$PAR
The question is asking us to compare the speed of the dragonfly to the speed of the butterfly. What are the speeds?

$BR
Speed of the dragonfly: \{SECTION_ANS($rate_a->cmp),$rate_a->ans_rule()\}

$BR
Speed of the butterfly: \{SECTION_ANS($unit_rate_b->cmp),$unit_rate_b->ans_rule()\}

END_SECTION

#Speed of the dragonfly: \{SECTION_ANS($rate_a->cmp),NAMED_ANS_RULE("rate_a",5)\}
#Speed of the butterfly: \{SECTION_ANS($rate_b->cmp),NAMED_ANS_RULE("rate_b",5)\}
#Speed of the dragonfly: \{SECTION_ANS($rate_a->cmp),$rate_a->ans_rule()\}
#Speed of the butterfly: \{SECTION_ANS($unit_rate_b->cmp),$unit_rate_b->ans_rule()\}
##############
#  Section 2
##############

Context()->texStrings;
DISPLAY_SECTION( { name=>"2: Compare the unit rates", 
             canshow =>$scaffold->requireCorrect(1,2),
             iscorrect=>$scaffold->requireCorrect(3,4), 
             section=>2 #designates that this is the first section
},   <<'END_SECTION'); 
$PAR
Which speed is greater?

\{SECTION_ANS($mc2->cmp),$mc2->buttons()\}

$PAR
How much greater is its speed?
$BR
\{SECTION_ANS($difference->cmp),$difference->ans_rule()\}

END_TEXT
#\{SECTION_ANS($difference->cmp),NAMED_ANS_RULE("diff",5)\}
#\{ $mc1->buttons() \}
#\{NAMED_ANS_RULE("mc2",5)\}

ANS( $mc1->cmp() );
ANS( $difference->cmp() );

END_SECTION


PROCESS_ANSWERS();

#Speed of the butterfly: \{SECTION_ANS($unit_rate_b->cmp), $unit_rate_b->ans_rule() \}
$last_correct_section = PROCESS_SECTIONS();

$opensection = $last_correct_section + 1;
$scaffold->openSections($opensection);
}

TEXT($END_ONE_COLUMN);
ENDDOCUMENT();    
